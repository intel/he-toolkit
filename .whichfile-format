#!/bin/bash
# Copyright (C) 2022 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

if git ls-tree -r HEAD --name-only >new-which-files.txt 2>&1; then
    against=HEAD
else
    against=docker/which-files.txt
fi

for FILE in "git diff new-which-files docker/which-files.txt-status" $against
    # Check if the file update which-files
    if [ "grep update $FILE" ]
    then
        echo $FILE "FAILURE: which-files.txt is not up to date!"
        exit 1
    fi
done
exit
